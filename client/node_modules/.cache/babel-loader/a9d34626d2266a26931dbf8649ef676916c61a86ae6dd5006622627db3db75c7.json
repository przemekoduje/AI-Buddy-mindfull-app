{"ast":null,"code":"var _jsxFileName = \"/Users/przemyslawrakotny/Documents/przemokoduje/full_projects/ai-buddy-mindfull-app/client/src/screens/BreathingSession.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport BreathingAnimation from '../components/BreathingAnimation';\nimport ControlPanel from '../components/ControlPanel';\nimport './BreathingSession.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BreathingSession = () => {\n  _s();\n  var _location$state;\n  const navigate = useNavigate();\n  const location = useLocation();\n  const durationInSeconds = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.duration) || 60;\n  const cycleTimeMs = 8000; // 8 sekund w milisekundach\n\n  const [isReady, setIsReady] = useState(false);\n  const [isPaused, setIsPaused] = useState(false);\n  const [remainingTime, setRemainingTime] = useState(durationInSeconds);\n  const [countdown, setCountdown] = useState(4);\n\n  // Stany do animacji JS\n  const [text, setText] = useState('Inhale');\n  const [scale, setScale] = useState(0.8);\n\n  // Refy do zarządzania pętlą animacji\n  const animationFrameId = useRef();\n  const cycleStartTime = useRef(performance.now());\n  const timePaused = useRef(0);\n\n  // Efekt 1: Odliczanie (bez zmian)\n  useEffect(() => {\n    const countdownInterval = setInterval(() => {\n      setCountdown(p => p <= 1 ? (clearInterval(countdownInterval), setIsReady(true), 0) : p - 1);\n    }, 1000);\n    return () => clearInterval(countdownInterval);\n  }, []);\n\n  // Efekt 2: Pętla animacji i logiki (NOWA, GŁÓWNA LOGIKA)\n  useEffect(() => {\n    const animate = timestamp => {\n      const elapsedSinceStart = timestamp - cycleStartTime.current;\n      const progress = elapsedSinceStart / cycleTimeMs % 1; // Progres w cyklu 0..1\n\n      // Obliczanie skali za pomocą funkcji sinus dla płynnego ruchu\n      const newScale = 0.8 + 0.4 * (0.5 * Math.sin(progress * 2 * Math.PI - Math.PI / 2) + 0.5);\n      setScale(newScale);\n\n      // Zmiana tekstu jest idealnie zsynchronizowana\n      setText(progress < 0.5 ? 'Inhale' : 'Exhale');\n      animationFrameId.current = requestAnimationFrame(animate);\n    };\n    if (isReady && !isPaused) {\n      // Wznawianie: dostosuj czas startu o czas spędzony w pauzie\n      cycleStartTime.current = performance.now() - timePaused.current;\n      animationFrameId.current = requestAnimationFrame(animate);\n    } else {\n      // Pauza: zapisz, ile czasu minęło w bieżącym cyklu\n      timePaused.current = performance.now() - cycleStartTime.current;\n      cancelAnimationFrame(animationFrameId.current);\n    }\n    return () => cancelAnimationFrame(animationFrameId.current);\n  }, [isReady, isPaused]);\n\n  // Efekt 3: Timer odliczania czasu sesji\n  useEffect(() => {\n    if (isReady && !isPaused && remainingTime > 0) {\n      const remainingTimeInterval = setInterval(() => setRemainingTime(t => t - 1), 1000);\n      return () => clearInterval(remainingTimeInterval);\n    }\n    if (remainingTime <= 0) navigate('/breathe');\n  }, [isReady, isPaused, remainingTime, navigate]);\n  const handlePlayPause = () => {\n    if (isReady) setIsPaused(p => !p);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"session-screen\",\n    children: [/*#__PURE__*/_jsxDEV(BreathingAnimation, {\n      isReady: isReady,\n      text: text,\n      countdown: countdown > 0 && countdown <= 3 ? countdown : null,\n      scale: scale // Przekazujemy aktualną skalę\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"session-screen__panel-wrapper\",\n      children: /*#__PURE__*/_jsxDEV(ControlPanel, {\n        onPlayPause: handlePlayPause,\n        isPlaying: !isPaused\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s(BreathingSession, \"553vC6/C+iZFqLo7II+QiNVvYS4=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = BreathingSession;\nexport default BreathingSession;\nvar _c;\n$RefreshReg$(_c, \"BreathingSession\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useLocation","useNavigate","BreathingAnimation","ControlPanel","jsxDEV","_jsxDEV","BreathingSession","_s","_location$state","navigate","location","durationInSeconds","state","duration","cycleTimeMs","isReady","setIsReady","isPaused","setIsPaused","remainingTime","setRemainingTime","countdown","setCountdown","text","setText","scale","setScale","animationFrameId","cycleStartTime","performance","now","timePaused","countdownInterval","setInterval","p","clearInterval","animate","timestamp","elapsedSinceStart","current","progress","newScale","Math","sin","PI","requestAnimationFrame","cancelAnimationFrame","remainingTimeInterval","t","handlePlayPause","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onPlayPause","isPlaying","_c","$RefreshReg$"],"sources":["/Users/przemyslawrakotny/Documents/przemokoduje/full_projects/ai-buddy-mindfull-app/client/src/screens/BreathingSession.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport BreathingAnimation from '../components/BreathingAnimation';\nimport ControlPanel from '../components/ControlPanel';\nimport './BreathingSession.scss';\n\nconst BreathingSession = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const durationInSeconds = location.state?.duration || 60;\n  const cycleTimeMs = 8000; // 8 sekund w milisekundach\n\n  const [isReady, setIsReady] = useState(false);\n  const [isPaused, setIsPaused] = useState(false);\n  const [remainingTime, setRemainingTime] = useState(durationInSeconds);\n  const [countdown, setCountdown] = useState(4);\n  \n  // Stany do animacji JS\n  const [text, setText] = useState('Inhale');\n  const [scale, setScale] = useState(0.8);\n  \n  // Refy do zarządzania pętlą animacji\n  const animationFrameId = useRef();\n  const cycleStartTime = useRef(performance.now());\n  const timePaused = useRef(0);\n\n  // Efekt 1: Odliczanie (bez zmian)\n  useEffect(() => {\n    const countdownInterval = setInterval(() => {\n      setCountdown(p => (p <= 1 ? (clearInterval(countdownInterval), setIsReady(true), 0) : p - 1));\n    }, 1000);\n    return () => clearInterval(countdownInterval);\n  }, []);\n\n  // Efekt 2: Pętla animacji i logiki (NOWA, GŁÓWNA LOGIKA)\n  useEffect(() => {\n    const animate = (timestamp) => {\n      const elapsedSinceStart = timestamp - cycleStartTime.current;\n      const progress = (elapsedSinceStart / cycleTimeMs) % 1; // Progres w cyklu 0..1\n\n      // Obliczanie skali za pomocą funkcji sinus dla płynnego ruchu\n      const newScale = 0.8 + 0.4 * (0.5 * Math.sin(progress * 2 * Math.PI - Math.PI / 2) + 0.5);\n      setScale(newScale);\n\n      // Zmiana tekstu jest idealnie zsynchronizowana\n      setText(progress < 0.5 ? 'Inhale' : 'Exhale');\n\n      animationFrameId.current = requestAnimationFrame(animate);\n    };\n\n    if (isReady && !isPaused) {\n      // Wznawianie: dostosuj czas startu o czas spędzony w pauzie\n      cycleStartTime.current = performance.now() - timePaused.current;\n      animationFrameId.current = requestAnimationFrame(animate);\n    } else {\n      // Pauza: zapisz, ile czasu minęło w bieżącym cyklu\n      timePaused.current = performance.now() - cycleStartTime.current;\n      cancelAnimationFrame(animationFrameId.current);\n    }\n\n    return () => cancelAnimationFrame(animationFrameId.current);\n  }, [isReady, isPaused]);\n\n  // Efekt 3: Timer odliczania czasu sesji\n  useEffect(() => {\n    if (isReady && !isPaused && remainingTime > 0) {\n      const remainingTimeInterval = setInterval(() => setRemainingTime(t => t - 1), 1000);\n      return () => clearInterval(remainingTimeInterval);\n    }\n    if (remainingTime <= 0) navigate('/breathe');\n  }, [isReady, isPaused, remainingTime, navigate]);\n\n  const handlePlayPause = () => {\n    if (isReady) setIsPaused(p => !p);\n  };\n\n  return (\n    <div className=\"session-screen\">\n      <BreathingAnimation \n        isReady={isReady} \n        text={text} \n        countdown={countdown > 0 && countdown <= 3 ? countdown : null}\n        scale={scale} // Przekazujemy aktualną skalę\n      />\n      <div className=\"session-screen__panel-wrapper\">\n        <ControlPanel onPlayPause={handlePlayPause} isPlaying={!isPaused} />\n      </div>\n    </div>\n  );\n};\n\nexport default BreathingSession;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}